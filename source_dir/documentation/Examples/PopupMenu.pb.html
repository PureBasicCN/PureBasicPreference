<html><head><title>PopupMenu.pb</title></head>
<body bgcolor="#EFF1F0" link="#3A3966" vlink="#000000" alink="#000000">
<pre><font face="Courier New, Courier, mono"size="2"><font color="#3A3966">;
</font><font color="#3A3966">; ------------------------------------------------------------
</font><font color="#3A3966">;
</font><font color="#3A3966">;   PureBasic - Menu example file
</font><font color="#3A3966">;
</font><font color="#3A3966">;    (c) Fantaisie Software
</font><font color="#3A3966">;
</font><font color="#3A3966">; ------------------------------------------------------------
</font><font color="#3A3966">;
</font>
<font color="#3A3966">;
</font><font color="#3A3966">; Create the popup menu. The indent is important here for a good lisibility
</font><font color="#3A3966">;
</font>
<b><font color="#3A3966">If</font></b> <font color="#3A3966">CreatePopupMenu</font>(0)
<font color="#3A3966">  MenuItem</font>(1, &quot;Cut&quot;)
<font color="#3A3966">  MenuItem</font>(2, &quot;Copy&quot;)
<font color="#3A3966">  MenuItem</font>(3, &quot;Paste&quot;)
<font color="#3A3966">  MenuBar</font>()
<font color="#3A3966">  OpenSubMenu</font>(&quot;Options&quot;)
<font color="#3A3966">    MenuItem</font>(4, &quot;Window...&quot;)
<font color="#3A3966">    MenuItem</font>(5, &quot;Gadget...&quot;)
<font color="#3A3966">  CloseSubMenu</font>()
<font color="#3A3966">  MenuBar</font>()
<font color="#3A3966">  MenuItem</font>( 6, &quot;Quit&quot;)
<b><font color="#3A3966">EndIf</font></b>

<font color="#3A3966">;
</font><font color="#3A3966">; We just have to open a window and see when an event happen on the menu
</font><font color="#3A3966">;
</font><b><font color="#3A3966">If</font></b> <font color="#3A3966">OpenWindow</font>(0, 100, 100, 300, 260, &quot;PureBasic - PopupMenu Example&quot;)

<font color="#3A3966">  ListIconGadget</font>(0, 10, 10, 280, 240, &quot;Tools&quot;, 200)
<font color="#3A3966">    AddGadgetItem</font>(0, -1, &quot;Hammer&quot;)
<font color="#3A3966">    AddGadgetItem</font>(0, -1, &quot;Screwdriver&quot;)

  <b><font color="#3A3966">Repeat</font></b>

    <b><font color="#3A3966">Select</font></b> <font color="#3A3966">WaitWindowEvent</font>()
        
      <b><font color="#3A3966">Case</font></b> <font color="#924B72">#PB_Event_Gadget</font>
        <b><font color="#3A3966">If</font></b> <font color="#3A3966">EventGadget</font>() = 0 <b><font color="#3A3966">And</font></b> <font color="#3A3966">EventType</font>() = <font color="#924B72">#PB_EventType_RightClick</font>
<font color="#3A3966">          DisplayPopupMenu</font>(0,<font color="#3A3966"> WindowID</font>(0))
        <b><font color="#3A3966">EndIf</font></b>
          
      <b><font color="#3A3966">Case</font></b> <font color="#924B72">#PB_Event_Menu</font>
      
        <b><font color="#3A3966">Select</font></b> <font color="#3A3966">EventMenu</font>()  <font color="#3A3966">; To see which menu has been selected
</font>
          <b><font color="#3A3966">Case</font></b> 1 <font color="#3A3966">; Cut
</font><font color="#3A3966">            MessageRequester</font>(&quot;PureBasic&quot;, &quot;Cut&quot;, 0)

          <b><font color="#3A3966">Case</font></b> 2 <font color="#3A3966">; Copy
</font><font color="#3A3966">            MessageRequester</font>(&quot;PureBasic&quot;, &quot;Copy&quot;, 0)

          <b><font color="#3A3966">Case</font></b> 3 <font color="#3A3966">; Paste
</font><font color="#3A3966">            MessageRequester</font>(&quot;PureBasic&quot;, &quot;Paste&quot;, 0)

          <b><font color="#3A3966">Case</font></b> 6 <font color="#3A3966">; Quit
</font>            Quit = 1

        <b><font color="#3A3966">EndSelect</font></b>
        
      <b><font color="#3A3966">Case</font></b> <font color="#924B72">#PB_Event_CloseWindow</font>
        Quit = 1

    <b><font color="#3A3966">EndSelect</font></b>

  <b><font color="#3A3966">Until</font></b> Quit = 1

<b><font color="#3A3966">EndIf</font></b>

<b><font color="#3A3966">End</font></b>  </font></pre>
</body></html>
